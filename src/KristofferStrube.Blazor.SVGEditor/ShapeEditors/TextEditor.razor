@inherits ShapeEditor<Text>

<ContextMenuTrigger MenuId="SVGMenu" WrapperTag="g" Data=@SVGElement StopPropagation=@(!SVGElement.IsChildElement)>
    <g transform="translate(@SVGElement.SVG.Translate.x.AsString() @SVGElement.SVG.Translate.y.AsString()) scale(@SVGElement.SVG.Scale.AsString())">
        <text tabindex="@(SVGElement.IsChildElement ? -1 : 0)"
        @ref=ElementReference
              x=@SVGElement.X.AsString()
              y=@SVGElement.Y.AsString()
              stroke="@SVGElement.Stroke"
              stroke-width="@SVGElement.StrokeWidth"
              fill="@SVGElement.Fill"
              style="pointer-events:none;">
            @((MarkupString)SVGElement.CharacterData.Replace(" ", "&nbsp;"))
            @foreach (BaseAnimate animate in SVGElement.AnimationElements)
            {
                var Parameters = new Dictionary<string, object> { { "SVGElement", animate } };
                <DynamicComponent Type=animate.Presenter Parameters=Parameters />
            }
        </text>
        <foreignObject x="@SVGElement.BoundingBox.X.AsString()"
                       y="@((SVGElement.BoundingBox.Y-1).AsString())"
                       width="@SVGElement.BoundingBox.Width.AsString()"
                       height="@SVGElement.BoundingBox.Height.AsString()"
        @onfocusin="FocusElement"
        @onkeyup="KeyUp"
        @onfocusout="UnfocusElement"
        @onpointerdown="Select">
            <input @bind="SVGElement.CharacterData"
            @bind:event="oninput" class="textInput" style="width:@SVGElement.BoundingBox.Width.AsString()px;" autocomplete="off" />
        </foreignObject>
    </g>
</ContextMenuTrigger>